{% extends "base.html" %} {% block page_title %} Login {% endblock page_title %}
{% block extra-style %}
<style>
  body {
    text-align: center;
    background-color: #ddd;
  }
  .inputBox {
    margin: auto;
    width: 70%;
    background: white;
    height: 50px;
    border-radius: 50px;
    line-height: 50px;
  }
  .inputBox .name {
    border-style: none;
    border-bottom: 1px solid #ddd;
    width: 90px;
    padding-left: 20px;
    line-height: 20px;
  }
  .inputBox .item {
    border-style: none;
    border-bottom: 1px solid #ddd;
    width: 400px;
    margin-left: 50px;
    padding-left: 20px;
    line-height: 20px;
  }
  .todoList {
    list-style: none;
    padding: 10px 0;
    text-align: left;
  }
  .todoList li {
    display: flex;
    height: 50px;
    line-height: 50px;
    margin: 0.5rem 0;
    padding: 0 0.9rem;
    background: white;
    border-radius: 5px;
  }
  .removeBtn {
    margin-left: auto;
    font-size: 20px;
  }
  .removeBtn:hover {
    color: red;
  }

  .login2 {
  flex: 1;
  display: flex;
  justify-content: center;
  align-items: center;
  
  font-family: Roboto, sans-serif;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-align: center;
  color: #2c3e50;
  margin: 0;
  flex-direction: column;
  min-height: 100vh;  
  background: #102a43;
  }

  .login-button {
    width: 100%;
    height: 35px;
    margin-top: 40px;
    border-radius: 3px;
    /* color: white; */
  }
  .login-form {
    width: 290px;
    height: 500px;
  }
  .user-item {
    padding-top: 50px;
  }
  .password-item {
    padding-top: 15px;
  }
  .forgot-password {
    margin-top: 10px;
  }


  .login .el-input__inner:hover {
    border-color: black;
  }
  .login .el-input__prefix {
    background: rgb(238, 237, 234);
    left: 0;
    height: calc(100% - 2px);
    left: 1px;
    top: 1px;
    border-radius: 3px;
  }
  .login .el-input input {
    padding-left: 35px;
  }
  .login .el-card {
    height: 400px;
    padding-top: 0;
    padding-bottom: 30px;
    border-radius: 10px;
    background-color: white;
  }
  h2 {
    font-family: "Open Sans";
    letter-spacing: 1px;
    font-family: Roboto, SansSerif;  
    padding-top: 40px;
    padding-bottom: 10px;
  }
  .login .el-card {
    width: 340px;
    display: flex;
    justify-content: center;
  }
</style>
{% endblock %} {% block content %}
<div id="app">
  <!-- import CSS -->
  <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
  <div class="inputBox" id="form">
    {% csrf_token %} 
    <input class="name" type="text" placeholder="사번" v-model.trim="id"/>
    <input class="item" type="text" placeholder="비밀번호" v-model.trim="password" v-on:keyup.enter="add_todo()"/>
    <button v-on:click="login()" class="btn btn-primary btn-sm">Login</button>
    <el-button @click="visible = true">Button</el-button>
    
  </div>
  <div class="login2">
    <el-card>
      <h2>Login</h2>
      <el-form
          class="login-form"
          :model="model"
          :rules="rules"
          ref="form"
          @submit.native.prevent="login"
        >
          <el-form-item class="user-item" prop="username">
            <el-input v-model="model.username" placeholder="Username" prefix-icon="fas fa-user"></el-input>
          </el-form-item>
          <el-form-item class="password-item" prop="password">
            <el-input
              v-model="model.password"
              placeholder="Password"
              type="password"
              prefix-icon="fas fa-lock"
            ></el-input>
          </el-form-item>
          <el-form-item>
            <el-button
              :loading="loading"
              class="login-button"
              type="primary"
              native-type="submit"
              block
            >Login</el-button>
          </el-form-item>
          <a class="forgot-password" href="https://oxfordinformatics.com/">Forgot password ?</a>
      </el-form>
    </el-card>
  </div>
  <br />
</div>

{% endblock content %} {% block extra-script %}
<script src="https://unpkg.com/vue/dist/vue.min.js"></script>
<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<!-- import JavaScript -->
<script src="https://unpkg.com/element-ui/lib/index.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/element-ui/2.13.2/index.js"></script>
<script src="cdnjs.cloudflare.com/ajax/libs/element-ui/2.13.2/locale/ko.min.js"></script> -->
<script>
  axios.defaults.xsrfCookieName = "csrftoken";
  axios.defaults.xsrfHeaderName = "X-CSRFToken";

  var vm = new Vue({
    el: "#app",
    data: {
      id: "",
      password: "",
      validCredentials: {
        username: "lightscope",
        password: "lightscope"
      },
      model: {
        username: "",
        password: ""
      },
      loading: false,
      rules: {
        username: [
          {
            required: true,
            message: "Username is required",
            trigger: "blur"
          },
          {
            min: 4,
            message: "Username length should be at least 5 characters",
            trigger: "blur"
          }
        ],
        password: [
          { required: true, message: "Password is required", trigger: "blur" },
          {
            min: 5,
            message: "Password length should be at least 5 characters",
            trigger: "blur"
          }
        ]
      }
    },
    methods: {
      login: function () {
        console.log("login...");

        
        var postData = {'id' : this.id, 'password': this.password};
        console.log(postData);
        
        axios.post('users/login', postData)
                    .then(function (res) {
                        console.log("POST RES", res);
                        console.log(res.data.login)
                        if(res.status == 200 && res.data.login){
                            location.href = 'http://127.0.0.1:8000/' + res.data.url
                            alert(res.data.login)
                        }else{
                            alert("로그인 실패")
                        }
                    })
                    .catch(function (err) {
                        console.log("POST ERR", err)
                    })
      },
    },
  });
</script>
{% endblock %}
